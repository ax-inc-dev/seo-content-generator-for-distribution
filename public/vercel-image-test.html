<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ğŸš€ Vercelç”»åƒç”Ÿæˆã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ å®Ÿé€£æºãƒ†ã‚¹ãƒˆ</title>
    <style>
      body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
          sans-serif;
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
        background: #f5f5f5;
      }

      .container {
        background: white;
        border-radius: 12px;
        padding: 30px;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
      }

      h1 {
        color: #333;
        text-align: center;
        margin-bottom: 30px;
      }

      .test-section {
        margin-bottom: 30px;
        padding: 20px;
        border: 2px solid #e0e0e0;
        border-radius: 8px;
      }

      .test-section h2 {
        color: #667eea;
        margin-bottom: 15px;
      }

      .warning {
        background: #fff3cd;
        border: 1px solid #ffeaa7;
        border-radius: 6px;
        padding: 15px;
        margin: 15px 0;
        font-size: 14px;
      }

      .success {
        background: #d4edda;
        border: 1px solid #c3e6cb;
        border-radius: 6px;
        padding: 15px;
        margin: 15px 0;
      }

      .error {
        background: #f8d7da;
        border: 1px solid #f5c6cb;
        border-radius: 6px;
        padding: 15px;
        margin: 15px 0;
      }

      input,
      select,
      textarea {
        width: 100%;
        padding: 10px;
        border: 1px solid #ddd;
        border-radius: 6px;
        font-size: 16px;
        margin-top: 5px;
      }

      button {
        background: #667eea;
        color: white;
        border: none;
        padding: 12px 24px;
        border-radius: 6px;
        cursor: pointer;
        font-size: 16px;
        margin: 5px;
      }

      button:hover {
        background: #5a67d8;
      }

      button:disabled {
        background: #ccc;
        cursor: not-allowed;
      }

      .progress {
        background: #f0f0f0;
        border-radius: 6px;
        padding: 15px;
        margin: 15px 0;
        font-family: monospace;
        white-space: pre-line;
        max-height: 400px;
        overflow-y: auto;
      }

      .results {
        background: #f8f9fa;
        border-radius: 6px;
        padding: 15px;
        margin: 15px 0;
      }

      .article-preview {
        background: #f8f9fa;
        border-radius: 6px;
        padding: 15px;
        margin: 10px 0;
        font-size: 14px;
      }

      .article-preview h3 {
        margin: 0 0 10px 0;
        color: #333;
      }

      .article-preview ul {
        margin: 5px 0;
        padding-left: 20px;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>ğŸš€ Vercelç”»åƒç”Ÿæˆã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ å®Ÿé€£æºãƒ†ã‚¹ãƒˆ</h1>

      <div class="warning">
        <strong>âš ï¸ é‡è¦:</strong>
        ã“ã®ãƒ†ã‚¹ãƒˆã¯å®Ÿéš›ã«ãƒ‡ãƒ—ãƒ­ã‚¤ã•ã‚Œã¦ã„ã‚‹ç”»åƒç”Ÿæˆã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã«æ¥ç¶šã—ã¾ã™ã€‚
        APIä½¿ç”¨æ–™é‡‘ãŒç™ºç”Ÿã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚ãƒ†ã‚¹ãƒˆå‰ã«æ–™é‡‘ä½“ç³»ã‚’ã”ç¢ºèªãã ã•ã„ã€‚
      </div>

      <!-- è¨­å®šã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
      <div class="test-section">
        <h2>âš™ï¸ è¨­å®š</h2>

        <div style="margin-bottom: 15px">
          <label for="imageAgentUrl">ç”»åƒç”Ÿæˆã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆURL:</label>
          <input
            type="text"
            id="imageAgentUrl"
            placeholder="https://ai-article-imager-for-wordpress.vercel.app"
            value="https://ai-article-imager-for-wordpress.vercel.app"
          />
          <small style="color: #666"
            >å®Ÿéš›ã«ãƒ‡ãƒ—ãƒ­ã‚¤ã•ã‚Œã¦ã„ã‚‹Vercelç”»åƒç”Ÿæˆã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®URLã‚’å…¥åŠ›ã—ã¦ãã ã•ã„</small
          >
        </div>

        <button onclick="testConnection()">ğŸ”— æ¥ç¶šãƒ†ã‚¹ãƒˆ</button>
        <div id="connectionStatus"></div>
      </div>

      <!-- å˜ä½“ãƒ†ã‚¹ãƒˆ -->
      <div class="test-section">
        <h2>ğŸ“„ å˜ä½“ãƒ†ã‚¹ãƒˆ</h2>

        <div style="margin-bottom: 15px">
          <label for="testArticleSelect">ãƒ†ã‚¹ãƒˆè¨˜äº‹ã‚’é¸æŠ:</label>
          <select id="testArticleSelect" onchange="previewArticle()">
            <option value="0">SEOå¯¾ç­–å®Œå…¨ã‚¬ã‚¤ãƒ‰ (H2: 4å€‹, H3: 12å€‹)</option>
            <option value="1">
              ãƒªãƒ¢ãƒ¼ãƒˆãƒ¯ãƒ¼ã‚¯æˆåŠŸã®ç§˜è¨£ (H2: 3å€‹, H3: 9å€‹)
            </option>
            <option value="2">AIæ´»ç”¨ã§æ¥­å‹™åŠ¹ç‡åŒ– (H2: 3å€‹, H3: 9å€‹)</option>
          </select>
        </div>

        <div id="articlePreview" class="article-preview"></div>

        <button onclick="testSingleArticle()">
          ğŸ¨ é¸æŠã—ãŸè¨˜äº‹ã§ç”»åƒç”Ÿæˆãƒ†ã‚¹ãƒˆ
        </button>

        <div id="singleProgress" class="progress" style="display: none"></div>
        <div id="singleResults" class="results" style="display: none"></div>
      </div>

      <!-- å…¨è¨˜äº‹ãƒ†ã‚¹ãƒˆ -->
      <div class="test-section">
        <h2>ğŸš€ å…¨è¨˜äº‹ãƒ†ã‚¹ãƒˆ</h2>
        <p>ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆè¨˜äº‹ã§é †æ¬¡ç”»åƒç”Ÿæˆã‚’å®Ÿè¡Œã—ã¾ã™</p>

        <button onclick="testAllArticles()">
          ğŸ¯ å…¨è¨˜äº‹ã§ç”»åƒç”Ÿæˆãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
        </button>

        <div id="allProgress" class="progress" style="display: none"></div>
        <div id="allResults" class="results" style="display: none"></div>
      </div>

      <!-- ã‚«ã‚¹ã‚¿ãƒ ãƒ†ã‚¹ãƒˆ -->
      <div class="test-section">
        <h2>âœï¸ ã‚«ã‚¹ã‚¿ãƒ ãƒ†ã‚¹ãƒˆ</h2>
        <p>ç‹¬è‡ªã®ãƒ‡ãƒ¼ã‚¿ã§ç”»åƒç”Ÿæˆã‚’ãƒ†ã‚¹ãƒˆ</p>

        <div style="margin-bottom: 15px">
          <label for="customTitle">è¨˜äº‹ã‚¿ã‚¤ãƒˆãƒ«:</label>
          <input
            type="text"
            id="customTitle"
            placeholder="ãƒ†ã‚¹ãƒˆè¨˜äº‹ã®ã‚¿ã‚¤ãƒˆãƒ«"
          />
        </div>

        <div style="margin-bottom: 15px">
          <label for="customKeyword">ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰:</label>
          <input
            type="text"
            id="customKeyword"
            placeholder="ãƒ¡ã‚¤ãƒ³ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰"
          />
        </div>

        <div style="margin-bottom: 15px">
          <label for="customHeadings">è¦‹å‡ºã— (1è¡Œ1è¦‹å‡ºã—):</label>
          <textarea
            id="customHeadings"
            rows="5"
            placeholder="è¦‹å‡ºã—1&#10;è¦‹å‡ºã—2&#10;è¦‹å‡ºã—3"
          ></textarea>
        </div>

        <button onclick="testCustomArticle()">
          ğŸ¨ ã‚«ã‚¹ã‚¿ãƒ ãƒ‡ãƒ¼ã‚¿ã§ç”»åƒç”Ÿæˆãƒ†ã‚¹ãƒˆ
        </button>

        <div id="customProgress" class="progress" style="display: none"></div>
        <div id="customResults" class="results" style="display: none"></div>
      </div>
    </div>

    <script>
      // ãƒ†ã‚¹ãƒˆç”¨è¨˜äº‹ãƒ‡ãƒ¼ã‚¿
      const testArticles = [
        {
          title: "SEOå¯¾ç­–å®Œå…¨ã‚¬ã‚¤ãƒ‰ï¼šæ¤œç´¢é †ä½ã‚’ä¸Šã’ã‚‹15ã®æ‰‹æ³•",
          keyword: "SEOå¯¾ç­–",
          characterCount: 8500,
          h2Items: [
            {
              text: "SEOå¯¾ç­–ã®åŸºæœ¬æ¦‚å¿µ",
              h3Items: [
                "æ¤œç´¢ã‚¨ãƒ³ã‚¸ãƒ³ã®ä»•çµ„ã¿",
                "SEOã®é‡è¦æ€§",
                "æ¤œç´¢ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®ç†è§£",
              ],
            },
            {
              text: "ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰æˆ¦ç•¥ã®ç«‹ã¦æ–¹",
              h3Items: [
                "ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰èª¿æŸ»ã®æ–¹æ³•",
                "ç«¶åˆåˆ†æ",
                "ãƒ­ãƒ³ã‚°ãƒ†ãƒ¼ãƒ«ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰æ´»ç”¨",
              ],
            },
            {
              text: "ã‚³ãƒ³ãƒ†ãƒ³ãƒ„æœ€é©åŒ–ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯",
              h3Items: [
                "ã‚¿ã‚¤ãƒˆãƒ«ã‚¿ã‚°æœ€é©åŒ–",
                "ãƒ¡ã‚¿ãƒ‡ã‚£ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³",
                "è¦‹å‡ºã—æ§‹é€ ã®æ”¹å–„",
              ],
            },
            {
              text: "æŠ€è¡“çš„SEOå¯¾ç­–",
              h3Items: ["ã‚µã‚¤ãƒˆé€Ÿåº¦æ”¹å–„", "ãƒ¢ãƒã‚¤ãƒ«æœ€é©åŒ–", "æ§‹é€ åŒ–ãƒ‡ãƒ¼ã‚¿å®Ÿè£…"],
            },
          ],
        },
        {
          title: "ãƒªãƒ¢ãƒ¼ãƒˆãƒ¯ãƒ¼ã‚¯æˆåŠŸã®ç§˜è¨£ï¼šç”Ÿç”£æ€§ã‚’3å€ã«ã™ã‚‹æ–¹æ³•",
          keyword: "ãƒªãƒ¢ãƒ¼ãƒˆãƒ¯ãƒ¼ã‚¯",
          characterCount: 6200,
          h2Items: [
            {
              text: "ãƒªãƒ¢ãƒ¼ãƒˆãƒ¯ãƒ¼ã‚¯ã®ç¾çŠ¶ã¨èª²é¡Œ",
              h3Items: [
                "å°å…¥ä¼æ¥­ã®å¢—åŠ å‚¾å‘",
                "ã‚ˆãã‚ã‚‹å•é¡Œç‚¹",
                "è§£æ±ºã™ã¹ãèª²é¡Œ",
              ],
            },
            {
              text: "åŠ¹ç‡çš„ãªä½œæ¥­ç’°å¢ƒã®æ§‹ç¯‰",
              h3Items: [
                "ãƒ›ãƒ¼ãƒ ã‚ªãƒ•ã‚£ã‚¹è¨­è¨ˆ",
                "å¿…è¦ãªãƒ„ãƒ¼ãƒ«ã¨æ©Ÿå™¨",
                "é›†ä¸­åŠ›ã‚’é«˜ã‚ã‚‹å·¥å¤«",
              ],
            },
            {
              text: "æ™‚é–“ç®¡ç†ã¨ã‚¿ã‚¹ã‚¯ç®¡ç†",
              h3Items: [
                "ãƒãƒ¢ãƒ‰ãƒ¼ãƒ­ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯",
                "ã‚¿ã‚¹ã‚¯å„ªå…ˆé †ä½ä»˜ã‘",
                "ãƒ‡ãƒƒãƒ‰ãƒ©ã‚¤ãƒ³ç®¡ç†",
              ],
            },
          ],
        },
        {
          title: "AIæ´»ç”¨ã§æ¥­å‹™åŠ¹ç‡åŒ–ï¼šä¸­å°ä¼æ¥­ã§ã‚‚å§‹ã‚ã‚‰ã‚Œã‚‹å®Ÿè·µã‚¬ã‚¤ãƒ‰",
          keyword: "AIæ´»ç”¨",
          characterCount: 7800,
          h2Items: [
            {
              text: "AIå°å…¥ã®åŸºç¤çŸ¥è­˜",
              h3Items: [
                "AIã®ç¨®é¡ã¨ç‰¹å¾´",
                "ä¸­å°ä¼æ¥­ã§ã®æ´»ç”¨ãƒ¡ãƒªãƒƒãƒˆ",
                "å°å…¥ã‚³ã‚¹ãƒˆã®è€ƒãˆæ–¹",
              ],
            },
            {
              text: "å…·ä½“çš„ãªAIæ´»ç”¨äº‹ä¾‹",
              h3Items: [
                "é¡§å®¢å¯¾å¿œã®è‡ªå‹•åŒ–",
                "ãƒ‡ãƒ¼ã‚¿åˆ†æã®åŠ¹ç‡åŒ–",
                "æ–‡æ›¸ä½œæˆæ”¯æ´",
              ],
            },
            {
              text: "AIå°å…¥ã®é€²ã‚æ–¹",
              h3Items: ["æ®µéšçš„å°å…¥è¨ˆç”»", "å¾“æ¥­å“¡æ•™è‚²", "åŠ¹æœæ¸¬å®šæ–¹æ³•"],
            },
          ],
        },
      ];

      // è¨˜äº‹ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼è¡¨ç¤º
      function previewArticle() {
        const selectedIndex =
          document.getElementById("testArticleSelect").value;
        const article = testArticles[selectedIndex];
        const preview = document.getElementById("articlePreview");

        let html = `<h3>${article.title}</h3>`;
        html += `<p><strong>ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰:</strong> ${
          article.keyword
        } | <strong>æ–‡å­—æ•°:</strong> ${article.characterCount.toLocaleString()}</p>`;
        html += `<p><strong>è¦‹å‡ºã—æ§‹é€ :</strong></p>`;

        article.h2Items.forEach((h2, index) => {
          html += `<p><strong>H2-${index + 1}:</strong> ${h2.text}</p>`;
          if (h2.h3Items.length > 0) {
            html += `<ul>`;
            h2.h3Items.forEach((h3) => {
              html += `<li>H3: ${h3}</li>`;
            });
            html += `</ul>`;
          }
        });

        preview.innerHTML = html;
      }

      // æ¥ç¶šãƒ†ã‚¹ãƒˆ
      async function testConnection() {
        const url = document.getElementById("imageAgentUrl").value;
        const statusDiv = document.getElementById("connectionStatus");

        if (!url) {
          statusDiv.innerHTML =
            '<div class="error">URLã‚’å…¥åŠ›ã—ã¦ãã ã•ã„</div>';
          return;
        }

        statusDiv.innerHTML = "<div>ğŸ”— æ¥ç¶šãƒ†ã‚¹ãƒˆä¸­...</div>";

        try {
          const response = await fetch(`${url}/api/health`, {
            method: "GET",
            headers: { Accept: "application/json" },
          });

          if (response.ok) {
            statusDiv.innerHTML =
              '<div class="success">âœ… æ¥ç¶šæˆåŠŸï¼ç”»åƒç”Ÿæˆã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã«æ­£å¸¸ã«æ¥ç¶šã§ãã¾ã—ãŸã€‚</div>';
          } else {
            statusDiv.innerHTML = `<div class="error">âŒ æ¥ç¶šå¤±æ•—: HTTP ${response.status}</div>`;
          }
        } catch (error) {
          statusDiv.innerHTML = `<div class="error">âŒ æ¥ç¶šã‚¨ãƒ©ãƒ¼: ${error.message}</div>`;
        }
      }

      // å˜ä½“è¨˜äº‹ãƒ†ã‚¹ãƒˆ
      async function testSingleArticle() {
        const url = document.getElementById("imageAgentUrl").value;
        const selectedIndex =
          document.getElementById("testArticleSelect").value;
        const article = testArticles[selectedIndex];

        if (!url) {
          alert("ç”»åƒç”Ÿæˆã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®URLã‚’å…¥åŠ›ã—ã¦ãã ã•ã„");
          return;
        }

        const progressDiv = document.getElementById("singleProgress");
        const resultsDiv = document.getElementById("singleResults");

        progressDiv.style.display = "block";
        resultsDiv.style.display = "none";
        progressDiv.textContent = "";

        try {
          await runImageGenerationTest(article, url, (message) => {
            progressDiv.textContent += message + "\n";
            progressDiv.scrollTop = progressDiv.scrollHeight;
          });
        } catch (error) {
          progressDiv.textContent += `âŒ ãƒ†ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼: ${error.message}\n`;
        }
      }

      // å…¨è¨˜äº‹ãƒ†ã‚¹ãƒˆ
      async function testAllArticles() {
        const url = document.getElementById("imageAgentUrl").value;

        if (!url) {
          alert("ç”»åƒç”Ÿæˆã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®URLã‚’å…¥åŠ›ã—ã¦ãã ã•ã„");
          return;
        }

        const progressDiv = document.getElementById("allProgress");
        const resultsDiv = document.getElementById("allResults");

        progressDiv.style.display = "block";
        resultsDiv.style.display = "none";
        progressDiv.textContent = "";

        const results = [];

        progressDiv.textContent += "ğŸš€ å…¨è¨˜äº‹ãƒ†ã‚¹ãƒˆé–‹å§‹\n";
        progressDiv.textContent += `ğŸ“Š ãƒ†ã‚¹ãƒˆå¯¾è±¡: ${testArticles.length}è¨˜äº‹\n\n`;

        for (let i = 0; i < testArticles.length; i++) {
          const article = testArticles[i];

          progressDiv.textContent += `ğŸ“„ ãƒ†ã‚¹ãƒˆ ${i + 1}/${
            testArticles.length
          }: ${article.title}\n`;

          try {
            const result = await runImageGenerationTest(
              article,
              url,
              (message) => {
                progressDiv.textContent += `   ${message}\n`;
                progressDiv.scrollTop = progressDiv.scrollHeight;
              }
            );

            results.push({ article: article.title, success: true, ...result });
          } catch (error) {
            progressDiv.textContent += `   âŒ å¤±æ•—: ${error.message}\n`;
            results.push({
              article: article.title,
              success: false,
              error: error.message,
            });
          }

          // æ¬¡ã®ãƒ†ã‚¹ãƒˆã¾ã§å¾…æ©Ÿ
          if (i < testArticles.length - 1) {
            progressDiv.textContent += "   â³ 3ç§’å¾…æ©Ÿ...\n\n";
            await new Promise((resolve) => setTimeout(resolve, 3000));
          }
        }

        // çµæœã‚µãƒãƒªãƒ¼
        const successCount = results.filter((r) => r.success).length;
        progressDiv.textContent += `\nğŸ‰ å…¨ãƒ†ã‚¹ãƒˆå®Œäº†\n`;
        progressDiv.textContent += `ğŸ“Š æˆåŠŸç‡: ${successCount}/${results.length}\n`;

        resultsDiv.style.display = "block";
        resultsDiv.innerHTML =
          "<h3>ğŸ“Š ãƒ†ã‚¹ãƒˆçµæœ</h3><pre>" +
          JSON.stringify(results, null, 2) +
          "</pre>";
      }

      // ã‚«ã‚¹ã‚¿ãƒ è¨˜äº‹ãƒ†ã‚¹ãƒˆ
      async function testCustomArticle() {
        const url = document.getElementById("imageAgentUrl").value;
        const title = document.getElementById("customTitle").value;
        const keyword = document.getElementById("customKeyword").value;
        const headings = document
          .getElementById("customHeadings")
          .value.split("\n")
          .filter((h) => h.trim());

        if (!url || !title || !keyword || headings.length === 0) {
          alert("ã™ã¹ã¦ã®é …ç›®ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„");
          return;
        }

        const customArticle = {
          title,
          keyword,
          characterCount: 5000,
          h2Items: headings.map((heading) => ({
            text: heading.trim(),
            h3Items: [],
          })),
        };

        const progressDiv = document.getElementById("customProgress");
        const resultsDiv = document.getElementById("customResults");

        progressDiv.style.display = "block";
        resultsDiv.style.display = "none";
        progressDiv.textContent = "";

        try {
          await runImageGenerationTest(customArticle, url, (message) => {
            progressDiv.textContent += message + "\n";
            progressDiv.scrollTop = progressDiv.scrollHeight;
          });
        } catch (error) {
          progressDiv.textContent += `âŒ ãƒ†ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼: ${error.message}\n`;
        }
      }

      // å®Ÿéš›ã®ç”»åƒç”Ÿæˆãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
      async function runImageGenerationTest(article, url, onProgress) {
        const startTime = Date.now();

        onProgress(`ğŸ¨ ç”»åƒç”Ÿæˆé–‹å§‹: ${article.title}`);
        onProgress(`ğŸ“Š H2è¦‹å‡ºã—æ•°: ${article.h2Items.length}`);

        // ç”»åƒç”Ÿæˆã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒæœŸå¾…ã™ã‚‹å½¢å¼ã§ãƒ‡ãƒ¼ã‚¿ã‚’æº–å‚™
        const payload = {
          article: {
            title: article.title,
            keyword: article.keyword,
            h2Items: article.h2Items,
            characterCount: article.characterCount,
            content: generateMockContent(article),
          },
          options: {
            imageCount: article.h2Items.length,
            style: "professional",
            size: "1024x1024",
          },
        };

        onProgress(`ğŸ“¡ ãƒ‡ãƒ¼ã‚¿é€ä¿¡ä¸­...`);

        const response = await fetch(`${url}/api/generate-images`, {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            Accept: "application/json",
          },
          body: JSON.stringify(payload),
        });

        const processingTime = Date.now() - startTime;

        if (!response.ok) {
          throw new Error(`HTTP ${response.status}: ${response.statusText}`);
        }

        const result = await response.json();

        onProgress(`âœ… ç”»åƒç”Ÿæˆå®Œäº† (${processingTime}ms)`);
        onProgress(`ğŸ–¼ï¸ ç”Ÿæˆã•ã‚ŒãŸç”»åƒæ•°: ${result.images?.length || 0}`);

        return {
          processingTime,
          imageCount: result.images?.length || 0,
          response: result,
        };
      }

      // ãƒ¢ãƒƒã‚¯ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ç”Ÿæˆ
      function generateMockContent(article) {
        let content = `# ${article.title}\n\n`;
        content += `ã“ã®è¨˜äº‹ã§ã¯ã€Œ${article.keyword}ã€ã«ã¤ã„ã¦è©³ã—ãè§£èª¬ã—ã¾ã™ã€‚\n\n`;

        article.h2Items.forEach((h2, index) => {
          content += `## ${h2.text}\n\n`;
          content += `${h2.text}ã«ã¤ã„ã¦èª¬æ˜ã—ã¾ã™ã€‚\n\n`;

          h2.h3Items.forEach((h3) => {
            content += `### ${h3}\n\n`;
            content += `${h3}ã«é–¢ã™ã‚‹è©³ç´°ãªèª¬æ˜ã‚’ã“ã“ã«è¨˜è¼‰ã—ã¾ã™ã€‚\n\n`;
          });
        });

        return content;
      }

      // åˆæœŸåŒ–
      document.addEventListener("DOMContentLoaded", function () {
        previewArticle();
      });
    </script>
  </body>
</html>
<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ğŸš€ Vercelç”»åƒç”Ÿæˆã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ å®Ÿé€£æºãƒ†ã‚¹ãƒˆ</title>
    <style>
      body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
          sans-serif;
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
        background: #f5f5f5;
      }

      .container {
        background: white;
        border-radius: 12px;
        padding: 30px;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
      }

      h1 {
        color: #333;
        text-align: center;
        margin-bottom: 30px;
      }

      .test-section {
        margin-bottom: 30px;
        padding: 20px;
        border: 2px solid #e0e0e0;
        border-radius: 8px;
      }

      .test-section h2 {
        color: #667eea;
        margin-bottom: 15px;
      }

      .warning {
        background: #fff3cd;
        border: 1px solid #ffeaa7;
        border-radius: 6px;
        padding: 15px;
        margin: 15px 0;
        font-size: 14px;
      }

      .success {
        background: #d4edda;
        border: 1px solid #c3e6cb;
        border-radius: 6px;
        padding: 15px;
        margin: 15px 0;
      }

      .error {
        background: #f8d7da;
        border: 1px solid #f5c6cb;
        border-radius: 6px;
        padding: 15px;
        margin: 15px 0;
      }

      input,
      select,
      textarea {
        width: 100%;
        padding: 10px;
        border: 1px solid #ddd;
        border-radius: 6px;
        font-size: 16px;
        margin-top: 5px;
      }

      button {
        background: #667eea;
        color: white;
        border: none;
        padding: 12px 24px;
        border-radius: 6px;
        cursor: pointer;
        font-size: 16px;
        margin: 5px;
      }

      button:hover {
        background: #5a67d8;
      }

      button:disabled {
        background: #ccc;
        cursor: not-allowed;
      }

      .progress {
        background: #f0f0f0;
        border-radius: 6px;
        padding: 15px;
        margin: 15px 0;
        font-family: monospace;
        white-space: pre-line;
        max-height: 400px;
        overflow-y: auto;
      }

      .results {
        background: #f8f9fa;
        border-radius: 6px;
        padding: 15px;
        margin: 15px 0;
      }

      .article-preview {
        background: #f8f9fa;
        border-radius: 6px;
        padding: 15px;
        margin: 10px 0;
        font-size: 14px;
      }

      .article-preview h3 {
        margin: 0 0 10px 0;
        color: #333;
      }

      .article-preview ul {
        margin: 5px 0;
        padding-left: 20px;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>ğŸš€ Vercelç”»åƒç”Ÿæˆã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ å®Ÿé€£æºãƒ†ã‚¹ãƒˆ</h1>

      <div class="warning">
        <strong>âš ï¸ é‡è¦:</strong>
        ã“ã®ãƒ†ã‚¹ãƒˆã¯å®Ÿéš›ã«ãƒ‡ãƒ—ãƒ­ã‚¤ã•ã‚Œã¦ã„ã‚‹ç”»åƒç”Ÿæˆã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã«æ¥ç¶šã—ã¾ã™ã€‚
        APIä½¿ç”¨æ–™é‡‘ãŒç™ºç”Ÿã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚ãƒ†ã‚¹ãƒˆå‰ã«æ–™é‡‘ä½“ç³»ã‚’ã”ç¢ºèªãã ã•ã„ã€‚
      </div>

      <!-- è¨­å®šã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
      <div class="test-section">
        <h2>âš™ï¸ è¨­å®š</h2>

        <div style="margin-bottom: 15px">
          <label for="imageAgentUrl">ç”»åƒç”Ÿæˆã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆURL:</label>
          <input
            type="text"
            id="imageAgentUrl"
            placeholder="https://ai-article-imager-for-wordpress.vercel.app"
            value="https://ai-article-imager-for-wordpress.vercel.app"
          />
          <small style="color: #666"
            >å®Ÿéš›ã«ãƒ‡ãƒ—ãƒ­ã‚¤ã•ã‚Œã¦ã„ã‚‹Vercelç”»åƒç”Ÿæˆã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®URLã‚’å…¥åŠ›ã—ã¦ãã ã•ã„</small
          >
        </div>

        <button onclick="testConnection()">ğŸ”— æ¥ç¶šãƒ†ã‚¹ãƒˆ</button>
        <div id="connectionStatus"></div>
      </div>

      <!-- å˜ä½“ãƒ†ã‚¹ãƒˆ -->
      <div class="test-section">
        <h2>ğŸ“„ å˜ä½“ãƒ†ã‚¹ãƒˆ</h2>

        <div style="margin-bottom: 15px">
          <label for="testArticleSelect">ãƒ†ã‚¹ãƒˆè¨˜äº‹ã‚’é¸æŠ:</label>
          <select id="testArticleSelect" onchange="previewArticle()">
            <option value="0">SEOå¯¾ç­–å®Œå…¨ã‚¬ã‚¤ãƒ‰ (H2: 4å€‹, H3: 12å€‹)</option>
            <option value="1">
              ãƒªãƒ¢ãƒ¼ãƒˆãƒ¯ãƒ¼ã‚¯æˆåŠŸã®ç§˜è¨£ (H2: 3å€‹, H3: 9å€‹)
            </option>
            <option value="2">AIæ´»ç”¨ã§æ¥­å‹™åŠ¹ç‡åŒ– (H2: 3å€‹, H3: 9å€‹)</option>
          </select>
        </div>

        <div id="articlePreview" class="article-preview"></div>

        <button onclick="testSingleArticle()">
          ğŸ¨ é¸æŠã—ãŸè¨˜äº‹ã§ç”»åƒç”Ÿæˆãƒ†ã‚¹ãƒˆ
        </button>

        <div id="singleProgress" class="progress" style="display: none"></div>
        <div id="singleResults" class="results" style="display: none"></div>
      </div>

      <!-- å…¨è¨˜äº‹ãƒ†ã‚¹ãƒˆ -->
      <div class="test-section">
        <h2>ğŸš€ å…¨è¨˜äº‹ãƒ†ã‚¹ãƒˆ</h2>
        <p>ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆè¨˜äº‹ã§é †æ¬¡ç”»åƒç”Ÿæˆã‚’å®Ÿè¡Œã—ã¾ã™</p>

        <button onclick="testAllArticles()">
          ğŸ¯ å…¨è¨˜äº‹ã§ç”»åƒç”Ÿæˆãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
        </button>

        <div id="allProgress" class="progress" style="display: none"></div>
        <div id="allResults" class="results" style="display: none"></div>
      </div>

      <!-- ã‚«ã‚¹ã‚¿ãƒ ãƒ†ã‚¹ãƒˆ -->
      <div class="test-section">
        <h2>âœï¸ ã‚«ã‚¹ã‚¿ãƒ ãƒ†ã‚¹ãƒˆ</h2>
        <p>ç‹¬è‡ªã®ãƒ‡ãƒ¼ã‚¿ã§ç”»åƒç”Ÿæˆã‚’ãƒ†ã‚¹ãƒˆ</p>

        <div style="margin-bottom: 15px">
          <label for="customTitle">è¨˜äº‹ã‚¿ã‚¤ãƒˆãƒ«:</label>
          <input
            type="text"
            id="customTitle"
            placeholder="ãƒ†ã‚¹ãƒˆè¨˜äº‹ã®ã‚¿ã‚¤ãƒˆãƒ«"
          />
        </div>

        <div style="margin-bottom: 15px">
          <label for="customKeyword">ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰:</label>
          <input
            type="text"
            id="customKeyword"
            placeholder="ãƒ¡ã‚¤ãƒ³ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰"
          />
        </div>

        <div style="margin-bottom: 15px">
          <label for="customHeadings">è¦‹å‡ºã— (1è¡Œ1è¦‹å‡ºã—):</label>
          <textarea
            id="customHeadings"
            rows="5"
            placeholder="è¦‹å‡ºã—1&#10;è¦‹å‡ºã—2&#10;è¦‹å‡ºã—3"
          ></textarea>
        </div>

        <button onclick="testCustomArticle()">
          ğŸ¨ ã‚«ã‚¹ã‚¿ãƒ ãƒ‡ãƒ¼ã‚¿ã§ç”»åƒç”Ÿæˆãƒ†ã‚¹ãƒˆ
        </button>

        <div id="customProgress" class="progress" style="display: none"></div>
        <div id="customResults" class="results" style="display: none"></div>
      </div>
    </div>

    <script>
      // ãƒ†ã‚¹ãƒˆç”¨è¨˜äº‹ãƒ‡ãƒ¼ã‚¿
      const testArticles = [
        {
          title: "SEOå¯¾ç­–å®Œå…¨ã‚¬ã‚¤ãƒ‰ï¼šæ¤œç´¢é †ä½ã‚’ä¸Šã’ã‚‹15ã®æ‰‹æ³•",
          keyword: "SEOå¯¾ç­–",
          characterCount: 8500,
          h2Items: [
            {
              text: "SEOå¯¾ç­–ã®åŸºæœ¬æ¦‚å¿µ",
              h3Items: [
                "æ¤œç´¢ã‚¨ãƒ³ã‚¸ãƒ³ã®ä»•çµ„ã¿",
                "SEOã®é‡è¦æ€§",
                "æ¤œç´¢ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®ç†è§£",
              ],
            },
            {
              text: "ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰æˆ¦ç•¥ã®ç«‹ã¦æ–¹",
              h3Items: [
                "ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰èª¿æŸ»ã®æ–¹æ³•",
                "ç«¶åˆåˆ†æ",
                "ãƒ­ãƒ³ã‚°ãƒ†ãƒ¼ãƒ«ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰æ´»ç”¨",
              ],
            },
            {
              text: "ã‚³ãƒ³ãƒ†ãƒ³ãƒ„æœ€é©åŒ–ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯",
              h3Items: [
                "ã‚¿ã‚¤ãƒˆãƒ«ã‚¿ã‚°æœ€é©åŒ–",
                "ãƒ¡ã‚¿ãƒ‡ã‚£ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³",
                "è¦‹å‡ºã—æ§‹é€ ã®æ”¹å–„",
              ],
            },
            {
              text: "æŠ€è¡“çš„SEOå¯¾ç­–",
              h3Items: ["ã‚µã‚¤ãƒˆé€Ÿåº¦æ”¹å–„", "ãƒ¢ãƒã‚¤ãƒ«æœ€é©åŒ–", "æ§‹é€ åŒ–ãƒ‡ãƒ¼ã‚¿å®Ÿè£…"],
            },
          ],
        },
        {
          title: "ãƒªãƒ¢ãƒ¼ãƒˆãƒ¯ãƒ¼ã‚¯æˆåŠŸã®ç§˜è¨£ï¼šç”Ÿç”£æ€§ã‚’3å€ã«ã™ã‚‹æ–¹æ³•",
          keyword: "ãƒªãƒ¢ãƒ¼ãƒˆãƒ¯ãƒ¼ã‚¯",
          characterCount: 6200,
          h2Items: [
            {
              text: "ãƒªãƒ¢ãƒ¼ãƒˆãƒ¯ãƒ¼ã‚¯ã®ç¾çŠ¶ã¨èª²é¡Œ",
              h3Items: [
                "å°å…¥ä¼æ¥­ã®å¢—åŠ å‚¾å‘",
                "ã‚ˆãã‚ã‚‹å•é¡Œç‚¹",
                "è§£æ±ºã™ã¹ãèª²é¡Œ",
              ],
            },
            {
              text: "åŠ¹ç‡çš„ãªä½œæ¥­ç’°å¢ƒã®æ§‹ç¯‰",
              h3Items: [
                "ãƒ›ãƒ¼ãƒ ã‚ªãƒ•ã‚£ã‚¹è¨­è¨ˆ",
                "å¿…è¦ãªãƒ„ãƒ¼ãƒ«ã¨æ©Ÿå™¨",
                "é›†ä¸­åŠ›ã‚’é«˜ã‚ã‚‹å·¥å¤«",
              ],
            },
            {
              text: "æ™‚é–“ç®¡ç†ã¨ã‚¿ã‚¹ã‚¯ç®¡ç†",
              h3Items: [
                "ãƒãƒ¢ãƒ‰ãƒ¼ãƒ­ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯",
                "ã‚¿ã‚¹ã‚¯å„ªå…ˆé †ä½ä»˜ã‘",
                "ãƒ‡ãƒƒãƒ‰ãƒ©ã‚¤ãƒ³ç®¡ç†",
              ],
            },
          ],
        },
        {
          title: "AIæ´»ç”¨ã§æ¥­å‹™åŠ¹ç‡åŒ–ï¼šä¸­å°ä¼æ¥­ã§ã‚‚å§‹ã‚ã‚‰ã‚Œã‚‹å®Ÿè·µã‚¬ã‚¤ãƒ‰",
          keyword: "AIæ´»ç”¨",
          characterCount: 7800,
          h2Items: [
            {
              text: "AIå°å…¥ã®åŸºç¤çŸ¥è­˜",
              h3Items: [
                "AIã®ç¨®é¡ã¨ç‰¹å¾´",
                "ä¸­å°ä¼æ¥­ã§ã®æ´»ç”¨ãƒ¡ãƒªãƒƒãƒˆ",
                "å°å…¥ã‚³ã‚¹ãƒˆã®è€ƒãˆæ–¹",
              ],
            },
            {
              text: "å…·ä½“çš„ãªAIæ´»ç”¨äº‹ä¾‹",
              h3Items: [
                "é¡§å®¢å¯¾å¿œã®è‡ªå‹•åŒ–",
                "ãƒ‡ãƒ¼ã‚¿åˆ†æã®åŠ¹ç‡åŒ–",
                "æ–‡æ›¸ä½œæˆæ”¯æ´",
              ],
            },
            {
              text: "AIå°å…¥ã®é€²ã‚æ–¹",
              h3Items: ["æ®µéšçš„å°å…¥è¨ˆç”»", "å¾“æ¥­å“¡æ•™è‚²", "åŠ¹æœæ¸¬å®šæ–¹æ³•"],
            },
          ],
        },
      ];

      // è¨˜äº‹ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼è¡¨ç¤º
      function previewArticle() {
        const selectedIndex =
          document.getElementById("testArticleSelect").value;
        const article = testArticles[selectedIndex];
        const preview = document.getElementById("articlePreview");

        let html = `<h3>${article.title}</h3>`;
        html += `<p><strong>ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰:</strong> ${
          article.keyword
        } | <strong>æ–‡å­—æ•°:</strong> ${article.characterCount.toLocaleString()}</p>`;
        html += `<p><strong>è¦‹å‡ºã—æ§‹é€ :</strong></p>`;

        article.h2Items.forEach((h2, index) => {
          html += `<p><strong>H2-${index + 1}:</strong> ${h2.text}</p>`;
          if (h2.h3Items.length > 0) {
            html += `<ul>`;
            h2.h3Items.forEach((h3) => {
              html += `<li>H3: ${h3}</li>`;
            });
            html += `</ul>`;
          }
        });

        preview.innerHTML = html;
      }

      // æ¥ç¶šãƒ†ã‚¹ãƒˆ
      async function testConnection() {
        const url = document.getElementById("imageAgentUrl").value;
        const statusDiv = document.getElementById("connectionStatus");

        if (!url) {
          statusDiv.innerHTML =
            '<div class="error">URLã‚’å…¥åŠ›ã—ã¦ãã ã•ã„</div>';
          return;
        }

        statusDiv.innerHTML = "<div>ğŸ”— æ¥ç¶šãƒ†ã‚¹ãƒˆä¸­...</div>";

        try {
          const response = await fetch(`${url}/api/health`, {
            method: "GET",
            headers: { Accept: "application/json" },
          });

          if (response.ok) {
            statusDiv.innerHTML =
              '<div class="success">âœ… æ¥ç¶šæˆåŠŸï¼ç”»åƒç”Ÿæˆã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã«æ­£å¸¸ã«æ¥ç¶šã§ãã¾ã—ãŸã€‚</div>';
          } else {
            statusDiv.innerHTML = `<div class="error">âŒ æ¥ç¶šå¤±æ•—: HTTP ${response.status}</div>`;
          }
        } catch (error) {
          statusDiv.innerHTML = `<div class="error">âŒ æ¥ç¶šã‚¨ãƒ©ãƒ¼: ${error.message}</div>`;
        }
      }

      // å˜ä½“è¨˜äº‹ãƒ†ã‚¹ãƒˆ
      async function testSingleArticle() {
        const url = document.getElementById("imageAgentUrl").value;
        const selectedIndex =
          document.getElementById("testArticleSelect").value;
        const article = testArticles[selectedIndex];

        if (!url) {
          alert("ç”»åƒç”Ÿæˆã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®URLã‚’å…¥åŠ›ã—ã¦ãã ã•ã„");
          return;
        }

        const progressDiv = document.getElementById("singleProgress");
        const resultsDiv = document.getElementById("singleResults");

        progressDiv.style.display = "block";
        resultsDiv.style.display = "none";
        progressDiv.textContent = "";

        try {
          await runImageGenerationTest(article, url, (message) => {
            progressDiv.textContent += message + "\n";
            progressDiv.scrollTop = progressDiv.scrollHeight;
          });
        } catch (error) {
          progressDiv.textContent += `âŒ ãƒ†ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼: ${error.message}\n`;
        }
      }

      // å…¨è¨˜äº‹ãƒ†ã‚¹ãƒˆ
      async function testAllArticles() {
        const url = document.getElementById("imageAgentUrl").value;

        if (!url) {
          alert("ç”»åƒç”Ÿæˆã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®URLã‚’å…¥åŠ›ã—ã¦ãã ã•ã„");
          return;
        }

        const progressDiv = document.getElementById("allProgress");
        const resultsDiv = document.getElementById("allResults");

        progressDiv.style.display = "block";
        resultsDiv.style.display = "none";
        progressDiv.textContent = "";

        const results = [];

        progressDiv.textContent += "ğŸš€ å…¨è¨˜äº‹ãƒ†ã‚¹ãƒˆé–‹å§‹\n";
        progressDiv.textContent += `ğŸ“Š ãƒ†ã‚¹ãƒˆå¯¾è±¡: ${testArticles.length}è¨˜äº‹\n\n`;

        for (let i = 0; i < testArticles.length; i++) {
          const article = testArticles[i];

          progressDiv.textContent += `ğŸ“„ ãƒ†ã‚¹ãƒˆ ${i + 1}/${
            testArticles.length
          }: ${article.title}\n`;

          try {
            const result = await runImageGenerationTest(
              article,
              url,
              (message) => {
                progressDiv.textContent += `   ${message}\n`;
                progressDiv.scrollTop = progressDiv.scrollHeight;
              }
            );

            results.push({ article: article.title, success: true, ...result });
          } catch (error) {
            progressDiv.textContent += `   âŒ å¤±æ•—: ${error.message}\n`;
            results.push({
              article: article.title,
              success: false,
              error: error.message,
            });
          }

          // æ¬¡ã®ãƒ†ã‚¹ãƒˆã¾ã§å¾…æ©Ÿ
          if (i < testArticles.length - 1) {
            progressDiv.textContent += "   â³ 3ç§’å¾…æ©Ÿ...\n\n";
            await new Promise((resolve) => setTimeout(resolve, 3000));
          }
        }

        // çµæœã‚µãƒãƒªãƒ¼
        const successCount = results.filter((r) => r.success).length;
        progressDiv.textContent += `\nğŸ‰ å…¨ãƒ†ã‚¹ãƒˆå®Œäº†\n`;
        progressDiv.textContent += `ğŸ“Š æˆåŠŸç‡: ${successCount}/${results.length}\n`;

        resultsDiv.style.display = "block";
        resultsDiv.innerHTML =
          "<h3>ğŸ“Š ãƒ†ã‚¹ãƒˆçµæœ</h3><pre>" +
          JSON.stringify(results, null, 2) +
          "</pre>";
      }

      // ã‚«ã‚¹ã‚¿ãƒ è¨˜äº‹ãƒ†ã‚¹ãƒˆ
      async function testCustomArticle() {
        const url = document.getElementById("imageAgentUrl").value;
        const title = document.getElementById("customTitle").value;
        const keyword = document.getElementById("customKeyword").value;
        const headings = document
          .getElementById("customHeadings")
          .value.split("\n")
          .filter((h) => h.trim());

        if (!url || !title || !keyword || headings.length === 0) {
          alert("ã™ã¹ã¦ã®é …ç›®ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„");
          return;
        }

        const customArticle = {
          title,
          keyword,
          characterCount: 5000,
          h2Items: headings.map((heading) => ({
            text: heading.trim(),
            h3Items: [],
          })),
        };

        const progressDiv = document.getElementById("customProgress");
        const resultsDiv = document.getElementById("customResults");

        progressDiv.style.display = "block";
        resultsDiv.style.display = "none";
        progressDiv.textContent = "";

        try {
          await runImageGenerationTest(customArticle, url, (message) => {
            progressDiv.textContent += message + "\n";
            progressDiv.scrollTop = progressDiv.scrollHeight;
          });
        } catch (error) {
          progressDiv.textContent += `âŒ ãƒ†ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼: ${error.message}\n`;
        }
      }

      // å®Ÿéš›ã®ç”»åƒç”Ÿæˆãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
      async function runImageGenerationTest(article, url, onProgress) {
        const startTime = Date.now();

        onProgress(`ğŸ¨ ç”»åƒç”Ÿæˆé–‹å§‹: ${article.title}`);
        onProgress(`ğŸ“Š H2è¦‹å‡ºã—æ•°: ${article.h2Items.length}`);

        // ç”»åƒç”Ÿæˆã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒæœŸå¾…ã™ã‚‹å½¢å¼ã§ãƒ‡ãƒ¼ã‚¿ã‚’æº–å‚™
        const payload = {
          article: {
            title: article.title,
            keyword: article.keyword,
            h2Items: article.h2Items,
            characterCount: article.characterCount,
            content: generateMockContent(article),
          },
          options: {
            imageCount: article.h2Items.length,
            style: "professional",
            size: "1024x1024",
          },
        };

        onProgress(`ğŸ“¡ ãƒ‡ãƒ¼ã‚¿é€ä¿¡ä¸­...`);

        const response = await fetch(`${url}/api/generate-images`, {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            Accept: "application/json",
          },
          body: JSON.stringify(payload),
        });

        const processingTime = Date.now() - startTime;

        if (!response.ok) {
          throw new Error(`HTTP ${response.status}: ${response.statusText}`);
        }

        const result = await response.json();

        onProgress(`âœ… ç”»åƒç”Ÿæˆå®Œäº† (${processingTime}ms)`);
        onProgress(`ğŸ–¼ï¸ ç”Ÿæˆã•ã‚ŒãŸç”»åƒæ•°: ${result.images?.length || 0}`);

        return {
          processingTime,
          imageCount: result.images?.length || 0,
          response: result,
        };
      }

      // ãƒ¢ãƒƒã‚¯ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ç”Ÿæˆ
      function generateMockContent(article) {
        let content = `# ${article.title}\n\n`;
        content += `ã“ã®è¨˜äº‹ã§ã¯ã€Œ${article.keyword}ã€ã«ã¤ã„ã¦è©³ã—ãè§£èª¬ã—ã¾ã™ã€‚\n\n`;

        article.h2Items.forEach((h2, index) => {
          content += `## ${h2.text}\n\n`;
          content += `${h2.text}ã«ã¤ã„ã¦èª¬æ˜ã—ã¾ã™ã€‚\n\n`;

          h2.h3Items.forEach((h3) => {
            content += `### ${h3}\n\n`;
            content += `${h3}ã«é–¢ã™ã‚‹è©³ç´°ãªèª¬æ˜ã‚’ã“ã“ã«è¨˜è¼‰ã—ã¾ã™ã€‚\n\n`;
          });
        });

        return content;
      }

      // åˆæœŸåŒ–
      document.addEventListener("DOMContentLoaded", function () {
        previewArticle();
      });
    </script>
  </body>
</html>
