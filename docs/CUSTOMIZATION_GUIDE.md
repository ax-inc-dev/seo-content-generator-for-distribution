# カスタマイズガイド

このガイドでは、SEOコンテンツ生成ツールを自社用にカスタマイズする方法を説明します。

## はじめに

### カスタマイズとは？

生成される記事に自社のサービス名や実績データを反映させることです。カスタマイズしなくても使えますが、設定すると記事の品質が上がります。

### いつやればいい？

| タイミング | 推奨度 |
|-----------|-------|
| ツールを動かす前 | ◎ 最初に設定しておくと楽 |
| ツールを動かした後 | ○ いつでも追加できます |
| デプロイ前 | ◎ 本番用の設定を入れておく |

### `.env`ファイルとは？

このガイドでよく出てくる `.env` ファイルは、ツールの設定を書くファイルです。プロジェクトフォルダの直下にあります。メモ帳やテキストエディタで開いて編集できます。

> **見つからない場合**: `.env.example` をコピーして `.env` にリネームしてください。

---

## 目次

1. [カスタマイズでできること](#カスタマイズでできること)
2. [記事生成の流れ](#記事生成の流れ)
3. [STEP 1: 会社名とサービス名を設定](#step-1-会社名とサービス名を設定)
4. [STEP 2: 自社の実績データを登録](#step-2-自社の実績データを登録)
5. [STEP 3: デフォルト画像を差し替え](#step-3-デフォルト画像を差し替え)
6. [STEP 4: 出典URLの優先順位を設定](#step-4-出典urlの優先順位を設定)
7. [STEP 5: スプレッドシートの準備](#step-5-スプレッドシートの準備)
8. [STEP 6: 一次情報データベースの設定（上級者向け）](#step-6-一次情報データベースの設定上級者向け)
9. [困ったときは](#困ったときは)
10. [設定一覧表](#設定一覧表)

---

## カスタマイズでできること

| カスタマイズ項目 | 初期状態 | カスタマイズ後 |
|----------------|---------|--------------|
| サービス名 | 「当社サービス」と表示 | 自社のサービス名が表示される |
| 会社名 | 「当社」と表示 | 自社の会社名が表示される |
| 実績データ | Google Drive未設定なら無効 | Google Driveに登録した実績が引用される |
| 記事内の画像 | 汎用画像 | 自社のブランドに合った画像 |
| 出典URL | ランダム | 自社のnote記事やメディアを優先 |

### カスタマイズレベル

1. **レベル1（環境変数のみ）**: `.env`ファイルの編集だけで完了
2. **レベル2（ファイル差し替え）**: 画像ファイル等の差し替え
3. **レベル3（コード修正）**: TypeScript/JavaScriptファイルの編集

---

## 記事生成の流れ

カスタマイズがどこで効いてくるか理解しておくと便利です。

```
1. キーワード入力
   ↓
2. 競合サイトを調査（上位サイトを分析）
   ↓
3. 記事の構成を作成
   └─ ここで「サービス名」が使われる
   ↓
4. 記事を執筆
   ├─ ここで「自社実績データ」が引用される（Google Drive設定時）
   └─ ここで「出典URL」の優先順位が適用される
   ↓
5. 記事を校正
   └─ ここで「会社名」を見て自社情報かどうか判定
   ↓
6. 画像を生成してWordPressに投稿
   └─ ここで「デフォルト画像」が使われる
```

---

## STEP 1: 会社名とサービス名を設定

一番かんたんなカスタマイズです。これだけでも記事の品質が上がります。

### 設定方法

1. プロジェクトフォルダ内の `.env` ファイルをメモ帳で開く
2. 以下の行を追加（または変更）：

```
VITE_SERVICE_NAME=あなたのサービス名
VITE_COMPANY_NAME=あなたの会社名
```

**入力例:**
```
VITE_SERVICE_NAME=AI研修サービス
VITE_COMPANY_NAME=株式会社サンプル
```

3. ファイルを保存

### どこに反映される？

| 設定項目 | 反映される場所 |
|---------|--------------|
| `VITE_SERVICE_NAME` | 記事内の「自社サービス訴求」セクション |
| `VITE_COMPANY_NAME` | AIが校正するときの自社判定 |

---

## STEP 2: 自社の実績データを登録

記事に「導入企業A社では○○%の削減を実現」のような実績データを入れたい場合の設定です。

> **ポイント**: 実績データはデフォルトで**有効**です。Google Driveを設定するだけで、すぐに記事に反映されます。

### 方法1: 設定ファイルを直接編集（おすすめ）

1. `services/companyMasterData.ts` ファイルを開く
2. 以下のような形式で実績データを追加：

```javascript
'クライアント企業名': {
  displayName: '○○社',
  industry: '業界名',
  results: {
    before: '導入前の状態',
    after: '導入後の状態',
    improvement: '改善内容（例: 作業時間90%削減）'
  },
  details: '補足説明'
}
```

**入力例:**
```javascript
'山田物流株式会社': {
  displayName: '山田物流様',
  industry: '物流・配送',
  results: {
    before: '配車計画に毎日3時間',
    after: '配車計画が30分で完了',
    improvement: '配車計画の作業時間を83%削減'
  },
  details: 'AIを活用した配車最適化システムを導入'
}
```

### 方法2: Googleドライブ連携（大量のデータがある場合）

1. 実績データをCSVファイルで作成
2. Googleドライブにアップロード
3. `.env` ファイルにフォルダIDを設定：

```
COMPANY_DATA_FOLDER_ID=ここにGoogleドライブのフォルダID
```

**フォルダIDの見つけ方:**
GoogleドライブでフォルダのURLを見ると `folders/` の後にIDが表示されます。
例: `https://drive.google.com/drive/folders/1ABC123xyz` → `1ABC123xyz`

### 実績データの有効化/無効化

**現在の設定:** 実績データはデフォルトで **有効** になっています。

Google Driveを設定するだけで、すぐに記事に実績データが挿入されます。

#### 使い方（デフォルト有効）

1. `.env` ファイルに `COMPANY_DATA_FOLDER_ID` を設定
2. Google DriveにCSVファイル（`pdf_segments_index.csv`）をアップロード
3. 記事を生成 → 実績データが自動で引用される

| 項目 | 説明 |
|------|------|
| Google Drive未設定時 | 実績データなしで記事が生成されます（エラーにはなりません） |
| Google Drive設定済み | 実績データが自動で記事に挿入されます |
| API失敗時 | 実績データなしで記事が生成されます |

#### 無効化する手順

実績データを使いたくない場合は、`useCompanyData: false` を追加してください：

1. `components/ArticleWriter.tsx` ファイルを開く
2. 267行目付近の `generateArticleV3` 呼び出しを探す
3. `useCompanyData: false` を追加：

```typescript
const v3Result = await generateArticleV3({
  outline: outlineMarkdown,
  keyword: keyword,
  targetAudience: actualOutline.targetAudience,
  tone: "professional",
  useGrounding: true,
  useCompanyData: false,  // ← この行を追加で無効化
});
```

### 上級者向け：最終校閲での実績データ活用

最終校閲エージェント（事例・ファクト検証）で自社実績データを参照させたい場合の設定です。

#### 修正ファイル

`services/finalProofreadingAgents/FactsCasesAgent.ts`

#### 現状の設定

デフォルトでは自社実績データは設定されていません。記事内の企業事例は、Web検索で実在性を確認します。

#### 自社実績データを追加する方法

自社の導入事例を「正確なデータ」として校閲エージェントに認識させたい場合は、プロンプトに実績データを追加します。

35行目の「【検証項目】」と「【出力形式】」の間に、以下のように追記してください：

```typescript
【検証項目】
1. 企業事例の実在性確認
2. 成功事例の数値検証
3. 業界事例の妥当性
4. ケーススタディの正確性
5. 統計データの出典確認

【自社実績データ（検証時の参照用）】
- 導入企業A様：〇〇業界、△△を実現
- 導入企業B様：〇〇業界、△△を実現
- 導入企業C様：〇〇業界、△△を実現

【出力形式】
```

#### 効果

この設定を行うと、最終校閲時に「この実績データは自社のものなので正確」と判定されるようになります。

---

## STEP 3: デフォルト画像を差し替え

記事内で使われる画像を自社のブランドに合ったものに変更できます。

### 画像ファイルの場所

```
ai-article-imager-for-wordpress/public/default-images/
├── サービス訴求.png       ← サービス紹介セクション用
├── とは・概要.jpg         ← 説明セクション用
├── メリット・おすすめ.png  ← メリット紹介用
├── デメリット・リスク.jpg  ← デメリット説明用
├── 解決策・ポイント.png    ← 解決策セクション用
└── よくある質問・FAQ.png   ← FAQセクション用
```

### 差し替え方法

1. 上記フォルダを開く
2. 同じファイル名で自社の画像を用意
3. 既存のファイルを上書き

**ポイント:**
- ファイル名は変えない（同じ名前で上書き）
- 画像サイズは横1200px程度がおすすめ
- PNG または JPG形式

---

## STEP 4: 出典URLの優先順位を設定

記事内で出典を引用するとき、自社のメディアを優先的に使うように設定できます。

### 設定方法

`.env` ファイルに以下を追加：

```
VITE_COMPANY_NOTE_URL=note.com/あなたの会社
VITE_COMPANY_MEDIA_URL=media.あなたの会社.com
VITE_COMPANY_SITE_URL=あなたの会社.com
```

**入力例:**
```
VITE_COMPANY_NOTE_URL=note.com/sample_company
VITE_COMPANY_MEDIA_URL=blog.sample.co.jp
VITE_COMPANY_SITE_URL=sample.co.jp
```

### 優先順位

設定すると、記事内の出典URLは以下の順番で選ばれます：

1. 自社のnote記事（最優先）
2. 自社のメディアサイト
3. 自社のコーポレートサイト
4. その他の外部サイト

---

## STEP 5: スプレッドシートの準備

キーワードをスプレッドシートで管理して一括処理したい場合の準備です。

### スプレッドシートの作成

Googleスプレッドシートを新規作成し、以下の形式で入力：

| A | B | C | D | E | F | G |
|---|---|---|---|---|---|---|
| No. | KW | 編集用URL | Slug | タイトル | 公開用URL | メタディスク |
| 1 | AI研修 助成金 | 1 | | | | |
| 2 | 生成AI 活用事例 | 1 | | | | |
| 3 | ChatGPT 業務効率化 | | | | | |

### 各列の意味

| 列 | 入力するもの | 自動/手動 |
|----|-------------|----------|
| A列 | 連番 | 手動 |
| B列 | 記事にしたいキーワード | 手動 |
| C列 | 処理したい行は `1` を入力 | 手動 |
| D列 | 記事のURL用文字列 | **自動入力** |
| E列 | 記事タイトル | **自動入力** |
| F列 | 公開後のURL（内部リンク用） | 手動 |
| G列 | メタディスクリプション | **自動入力** |

### 環境変数の設定

`.env` ファイルにスプレッドシートのIDを追加：

```
SPREADSHEET_ID=ここにスプレッドシートのID
```

**スプレッドシートIDの見つけ方:**
スプレッドシートのURLの `/d/` と `/edit` の間の文字列がIDです。
例: `https://docs.google.com/spreadsheets/d/1ABC123xyz/edit` → `1ABC123xyz`

---

## STEP 6: 一次情報データベースの設定（上級者向け）

自社の専門知識やノウハウをデータベースに蓄積し、記事生成時に参照させる機能です。

**注意:** この設定はオプションです。設定しなくても記事生成は正常に動作します。

### Supabaseとは？

無料で使えるデータベースサービスです。自社の専門知識をここに登録しておくと、記事執筆時にAIが参照してくれます。

### 使う場合の設定

1. [Supabase](https://supabase.com/) でアカウント作成
2. 新しいプロジェクトを作成
3. `.env` ファイルに接続情報を追加：

```
VITE_SUPABASE_URL=https://xxxxx.supabase.co
VITE_SUPABASE_ANON_KEY=eyJhbGciOiJIUzI1NiIs...（長い文字列）
```

### 使わない場合

何も設定しなくてOKです。以下のようなメッセージが出ますが、エラーではありません：

```
[Supabase] 環境変数が設定されていません。Supabase機能は無効化されます。
```

---

## 困ったときは

### サービス名が変わらない

1. `.env` ファイルに `VITE_SERVICE_NAME=〇〇` が正しく書かれているか確認
2. ツールを再起動（一度止めて、もう一度 `npm run dev`）
3. 本番環境の場合は再ビルドが必要

### 実績データが反映されない

1. `.env` の `COMPANY_DATA_FOLDER_ID` が正しいか確認
2. Google DriveにCSVファイルがアップロードされているか確認
3. CSVのデータ形式が正しいか確認
4. ツールを再起動
5. `useCompanyData: false` が設定されていないか確認（デフォルト有効のため、この設定があると無効になる）

### 画像が表示されない

1. ファイル名が完全に同じか確認（大文字・小文字、拡張子）
2. ブラウザのキャッシュをクリア（Ctrl + Shift + R）

---

## 設定一覧表

### 環境変数（.envファイル）

| 設定名 | 必須？ | 説明 | 例 |
|--------|--------|------|-----|
| `VITE_SERVICE_NAME` | - | 自社サービス名 | `AI研修サービス` |
| `VITE_COMPANY_NAME` | - | 自社会社名 | `株式会社サンプル` |
| `VITE_COMPANY_NOTE_URL` | - | noteのURL | `note.com/sample` |
| `VITE_COMPANY_MEDIA_URL` | - | メディアサイトURL | `blog.sample.co.jp` |
| `VITE_COMPANY_SITE_URL` | - | コーポレートサイト | `sample.co.jp` |
| `COMPANY_DATA_FOLDER_ID` | - | 実績データのフォルダID | `1ABC123xyz` |
| `SPREADSHEET_ID` | - | スプレッドシートID | `1ABC123xyz` |
| `VITE_SUPABASE_URL` | - | Supabase URL | `https://xxx.supabase.co` |
| `VITE_SUPABASE_ANON_KEY` | - | Supabaseキー | `eyJhbGci...` |

### ファイル（直接編集）

| ファイル | 編集内容 |
|---------|---------|
| `.env` | 環境変数の設定 |
| `services/companyMasterData.ts` | クライアント実績データ |
| `ai-article-imager-for-wordpress/public/default-images/` | デフォルト画像 |

---

## おすすめのカスタマイズ順序

まずは簡単なものから始めて、徐々に追加していくのがおすすめです。

1. **まずはこれだけ**: 会社名・サービス名の設定（STEP 1）
2. **次に**: 自社実績データの登録（STEP 2）
3. **余裕があれば**: 出典URLの優先順位（STEP 4）
4. **量産するなら**: スプレッドシートの準備（STEP 5）
5. **こだわるなら**: 画像の差し替え（STEP 3）
